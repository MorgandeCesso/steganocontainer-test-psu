# DOCX Stego Prototype

Так, ну, в целом вот, вроде как стегаконтейнер +- по логике статьи получился.

## Как это работает

### Как шифруется и встраивается

1. **Шифрование данных**
   - Исходный текст/файл преобразуется в байты
   - Генерируется случайная соль (16 байт) и nonce (12 байт)
   - Пароль преобразуется в ключ шифрования через алгоритм scrypt (n=2^15, r=8, p=1)
   - Данные шифруются алгоритмом AES-GCM с использованием полученного ключа
   - Формируется пакет: маркер `STEGDOC1` (8 байт) + соль + nonce + длина шифротекста + шифротекст

2. **Встраивание в изображение**
   - PNG изображение конвертируется в RGB формат
   - В младшие биты каждого RGB канала встраиваются биты зашифрованных данных
   - Каждый пиксель содержит 3 бита данных (по одному на канал R, G, B)
   - Перед данными записывается 4-байтовый префикс с длиной полезной нагрузки
   - Создается стегоизображение (визуально идентичное оригиналу)

3. **Создание DOCX документа**
   - Создается новый DOCX документ с заголовком и описанием
   - Стегоизображение вставляется в документ как обычное изображение
   - DOCX сохраняется (изображение хранится в `word/media/*.png`)

### Как это дело извлекается

1. **Пуллим пикчу из DOCX**
   - DOCX файл открывается как ZIP архив
   - Находится первое PNG изображение в папке `word/media/`
   - Изображение извлекается во временный файл

2. **Пуллим данные из изображения**
   - Изображение конвертируется в RGB
   - Из младших битов каждого RGB канала извлекаются биты данных
   - Читается 4-байтовый префикс с длиной полезной нагрузки
   - Извлекается зашифрованный пакет данных

3. **Расшифровка**
   - Проверяется маркер `STEGDOC1`
   - Извлекаются соль и nonce из заголовка пакета
   - Пароль преобразуется в ключ через scrypt с использованием сохраненной соли
   - Данные расшифровываются алгоритмом AES-GCM
   - Возвращается исходный текст/файл

## Мб понадобится

- **Алгоритм шифрования** - AES-GCM (256-битный ключ)
- **Производная ключа** - scrypt (n=32768, r=8, p=1)
- **Метод стеганографии** - LSB (Least Significant Bit) в RGB каналах
- **Формат изображения** - PNG (обязательно lossless, JPG не поддерживается)
- **Емкость** - ~3 бита на пиксель (ширина × высота × 3 / 8 байт)

## Запуск

### Генерация документа с стегоконтейнером внутри изображения
```bash
python main.py embed --cover-png cover.png --message "Секретный блок отчёта A3. Доступ: роль Инженер." --password "StrongPass123" --out-docx report.docx
```

### Извлечение стегоконтейнера из документа
```bash
python main.py extract --in-docx report.docx --password "StrongPass123"
```